!function(t,e){"use strict";"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.PureWizard=e()}(this,function(){"use strict";function t(t,e){return t.classList?t.classList.contains(e):!!t.className.match(new RegExp("(\\s|^)"+e+"(\\s|$)"))}function e(e,i){i&&(e.classList?e.classList.add(i):t(i)||(e.className=e.className.trim()+" "+i))}function i(e,i){i&&(e.classList?e.classList.remove(i):t(i)&&(e.className=e.className.replace(new RegExp("(^|\\s)"+i.split(" ").join("|")+"(\\s|$)","gi")," ")))}function n(t){function e(){for(a=0;a<c.length;a++)if(l=c[a],0===u.pages.length)u.pages.push(new s(u.config,l)),u.current=u.pages[0];else{var t=u.pages[u.pages.length-1],e=new s(u.config,l,t);u.pages.push(e),t.next=e}}function i(){var t=document.getElementById(u.statusSectionId);u.statusSection=new r(u.pages,t,u.config.statusContainerCfg),t.addEventListener("click",function(t){var e=t.target;if("a"===e.tagName.toLocaleLowerCase()){var i=Number(e.attributes["data-step"].value),n=u.currentIndex;(!u.goToPage(i)||n>i)&&u.current.toggleErrors()}})}if(!t||!t.wizardNodeId)throw new Error("PureWizard init error - wizardNodeId should be defined");if(this.config={},Object.keys(o).forEach(function(e){this.config[e]=t.hasOwnProperty(e)?t[e]:o[e]},this),this.pages=[],this.current=null,this.currentIndex=0,this.form=document.getElementById(this.config.wizardNodeId),this.statusSectionId=this.config.statusContainerCfg.containerId,this.buttons={next:this.form.querySelector(".pwNext"),prev:this.form.querySelector(".pwPrev"),finish:this.form.querySelector(".pwFinish")},this.buttonsInitialDisplay={next:this.buttons.next.style.display,prev:this.buttons.prev.style.display,finish:this.buttons.finish.style.display},!this.buttons.next)throw new Error("PureWizard init error - next button not found, create one with class 'pwNext'");if(!this.buttons.prev)throw new Error("PureWizard init error - previouse button not found, create one with class 'pwPrev'");var a,l,u=this,c=this.form.querySelectorAll("#"+this.config.wizardNodeId+">"+this.config.stepsSplitCssQuery);if(0===c.length)throw new Error("Can't find the sections to divide wizard, please check the stepsSplitCssQuery option.");e(),this.statusSectionId&&document.getElementById(this.statusSectionId)&&i(),this.pages.forEach(function(t){t.hide()}),u.goToPage(this.config.startPage,!0),this.buttons.next.addEventListener("click",function(){n.prototype.next.call(u)}),this.buttons.prev.addEventListener("click",function(){n.prototype.prev.call(u)}),this.buttons.finish&&this.buttons.finish.addEventListener("click",function(t){return u.current.toggleErrors()?(t.preventDefault(),!1):void(u.onSubmitCallback?u.onSubmitCallback(t,{}):u.form.submit())}),this.form.addEventListener("reset",function(){u.goToPage(0)})}function s(t,e,i,n){this.el=e,this.prev=i||null,this.next=n||null,this.config=t}function r(t,i,n){this.config=n;var s,r,o=n.ulClass||"",a=n.liClass||"",l=n.aClass||"",u=this;this.el=document.createElement("ul"),e(this.el,o),t.forEach(function(t,i){s=document.createElement("li"),r=document.createElement("a"),e(s,a),r.setAttribute("href","#"),r.setAttribute("data-step",i.toString()),r.appendChild(document.createTextNode(t.getTitle())),e(r,l),s.appendChild(r),u.el.appendChild(s)}),i.appendChild(u.el)}var o={wizardNodeId:"",errorClass:"has-error",statusContainerCfg:{},stepsSplitCssQuery:"fieldset",hideNextPrevButtons:!0,startPage:0};return n.prototype.next=function(){this.current.getNext()&&(this.goToPage(this.currentIndex+1)||this.current.toggleErrors())},n.prototype.prev=function(){this.current.getPrev()&&(this.goToPage(this.currentIndex-1),this.current.toggleErrors())},n.prototype.getCurrentPage=function(){return this.current},n.prototype.getCurrentPageNumber=function(){return this.currentIndex},n.prototype.onPageChanged=function(t){this.form.addEventListener("onPWPageChanged",function(e){t(e)})},n.prototype.onSubmit=function(t){this.onSubmitCallback=t},n.prototype.goToPage=function(t,e){t>=this.pages.length&&(t=this.pages.length-1),t<0&&(t=0);var i=this.pages[t];if(this.current.isValid()||this.currentIndex>t||e){if(!e&&this.currentIndex<t&&this.currentIndex+1!==t&&this.pages.filter(function(e,i){return!e.isValid()&&i!==t}).length>0)return!1;this.current.hide(),this.current=i,this.current.show(),this.currentIndex=t,this.statusSection&&this.statusSection.setStep(t),this.toggleButtons();var n=new CustomEvent("onPWPageChanged",{detail:{previousPage:this.currentIndex,currentPage:this.currentIndex+1}});return this.form.dispatchEvent(n),!0}return!1},n.prototype.toggleButtons=function(){function t(t,i,n){e.config.hideNextPrevButtons?t.style.display=n?i:"none":t.disabled=!n}var e=this;e.buttons.finish.style.display="none",this.current.getPrev()?t(e.buttons.prev,e.buttonsInitialDisplay.prev,!0):t(e.buttons.prev,e.buttonsInitialDisplay.prev,!1),this.current.getNext()?t(e.buttons.next,e.buttonsInitialDisplay.next,!0):(t(e.buttons.next,e.buttonsInitialDisplay.next,!1),e.buttons.finish.style.display=e.buttonsInitialDisplay.finish)},s.prototype.getInvalidElements=function(){return this.el.querySelectorAll(":invalid")},s.prototype.isValid=function(){return 0===this.getInvalidElements().length},s.prototype.toggleErrors=function(){var n,s,r,o,a=this.getInvalidElements(),l=!1;for(n=0;n<a.length;n++)s=this.el.querySelector('label[for="'+a[n].id+'"]'),t(a[n],this.config.errorClass)||(e(a[n],this.config.errorClass),s&&!t(s,this.config.errorClass)&&e(s,this.config.errorClass),r=a[n].getAttribute("data-error-msg"),o=document.getElementById(a[n].id+"Error"),r&&o&&(o.innerHTML=r)),l=!0;var u=this.config.errorClass?"."+this.config.errorClass:"",c=this.el.querySelectorAll(u+":valid");for(n=0;n<c.length;n++)i(c[n],this.config.errorClass),s=this.el.querySelector('label[for="'+c[n].id+'"]'),o=document.getElementById(c[n].id+"Error"),s&&i(s,this.config.errorClass),o&&(o.innerHTML="");return l},s.prototype.getTitle=function(){var t=this.el.querySelector(".pwStepTitle");if(!t)throw new Error("PureWizard error - no title for page, please add with '.pwStepTitle' class.");return t.innerHTML},s.prototype.getNext=function(){return this.next},s.prototype.getPrev=function(){return this.prev},s.prototype.show=function(){this.config.hideClass?this.el.className=this.el.className.replace(this.config.hideClass,""):this.el.style.display=""},s.prototype.hide=function(){this.config.hideClass?e(this.el,this.config.hideClass):this.el.style.display="none"},r.prototype.setStep=function(t){var n=this.el.querySelector("."+this.config.aActiveClass);n&&i(n,this.config.aActiveClass),e(this.el.children[t],this.config.aActiveClass)},n});